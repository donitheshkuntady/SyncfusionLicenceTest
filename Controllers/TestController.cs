using Microsoft.AspNetCore.Mvc;
using Syncfusion.EJ2.DocumentEditor;


namespace SyncfusionLicenceTest.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class TestController : ControllerBase
    {
        [HttpGet]
        public void Save()
        {
            string sfdtContent = "{\"optimizeSfdt\":true,\"sec\":[{\"secpr\":{\"pw\":612,\"ph\":792,\"lm\":72,\"rm\":72,\"tm\":72,\"bm\":72,\"hd\":36,\"fd\":36,\"dfp\":0,\"doep\":0,\"bi\":0,\"bc\":\"NewPage\",\"enf\":2,\"fnf\":0,\"rif\":0,\"rie\":0,\"ifn\":1,\"ien\":1,\"pgns\":\"Arabic\",\"ncols\":1,\"eqw\":1,\"lbtc\":0,\"cols\":[]},\"b\":[{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"ls\":1,\"lst\":0,\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"bi\":false},\"i\":[{\"cf\":{\"bi\":false},\"tlp\":\"This is a data that we are passing in the DocTemplate.\"},{\"cf\":{\"bi\":false},\"tlp\":\"\\u000b\"},{\"cf\":{\"bi\":false},\"tlp\":\"This is a normal FormTemplate variable: <<[(ft_templateA_causesGlobalWarming)]>>\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"ls\":1,\"lst\":0,\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"bi\":false},\"i\":[{\"cf\":{\"bi\":false},\"tlp\":\"<<[(ft_templateA_oceanGlobalWarming)]>>This a conditional statement- success\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"ls\":1,\"lst\":0,\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"bi\":false},\"i\":[{\"cf\":{\"bi\":false},\"tlp\":\"<<foreach [item in (ft_templateA_globalWarming)]>>\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"fin\":36,\"ls\":1,\"lst\":0,\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"bi\":false},\"i\":[{\"cf\":{\"bi\":false},\"tlp\":\"- This is foreach loop\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"fin\":0,\"ls\":1,\"lst\":0,\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"bi\":false},\"i\":[{\"cf\":{\"bi\":false},\"tlp\":\"<</foreach>>\"}]},{\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"fin\":0,\"ls\":1,\"lst\":0,\"stn\":\"Normal\",\"lif\":{}},\"cf\":{\"bi\":false},\"i\":[{\"cf\":{\"bi\":false},\"tlp\":\"This in total will have 3 form template variables\"}]}],\"hf\":{}}],\"cf\":{\"b\":false,\"i\":false,\"fsz\":11,\"ff\":\"Calibri\",\"u\":0,\"st\":0,\"ba\":0,\"hc\":0,\"fszbi\":11,\"ffbi\":\"Calibri\",\"ac\":false,\"ffa\":\"Calibri\",\"ffnfe\":\"Calibri\",\"fffe\":\"Calibri\"},\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":0,\"as\":0,\"ls\":1,\"lst\":0,\"ol\":0,\"bi\":false,\"klt\":false,\"kwn\":false,\"wc\":true,\"lif\":{}},\"fst\":{},\"tfl\":{},\"dtw\":36,\"tc\":0,\"enf\":0,\"hv\":\"\",\"sv\":\"\",\"fmt\":0,\"pt\":0,\"dhtml\":0,\"ffs\":1,\"comp\":0,\"stytbl\":0,\"bg\":{\"c\":\"#FFFFFF\"},\"sty\":[{\"n\":\"Normal\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lif\":{}},\"cf\":{},\"nx\":\"Normal\"},{\"n\":\"Heading 1\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":12,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":1,\"lif\":{}},\"cf\":{\"fsz\":16,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 1 Char\",\"t\":1,\"cf\":{\"fsz\":16,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Default Paragraph Font\",\"t\":1,\"cf\":{}},{\"n\":\"Heading 2\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":2,\"lif\":{}},\"cf\":{\"fsz\":13,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 2 Char\",\"t\":1,\"cf\":{\"fsz\":13,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 3\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":3,\"lif\":{}},\"cf\":{\"fsz\":12,\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 3 Char\",\"t\":1,\"cf\":{\"fsz\":12,\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 4\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":4,\"lif\":{}},\"cf\":{\"i\":true,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 4 Char\",\"t\":1,\"cf\":{\"i\":true,\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 5\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":5,\"lif\":{}},\"cf\":{\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 5 Char\",\"t\":1,\"cf\":{\"ff\":\"Calibri Light\",\"fc\":\"#2F5496\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 6\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":6,\"lif\":{}},\"cf\":{\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 6 Char\",\"t\":1,\"cf\":{\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 7\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":7,\"lif\":{}},\"cf\":{\"i\":true,\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 7 Char\",\"t\":1,\"cf\":{\"i\":true,\"ff\":\"Calibri Light\",\"fc\":\"#1F3763\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 8\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":8,\"lif\":{}},\"cf\":{\"fsz\":10.5,\"ff\":\"Calibri Light\",\"fc\":\"#333333\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 8 Char\",\"t\":1,\"cf\":{\"fsz\":10.5,\"ff\":\"Calibri Light\",\"fc\":\"#333333\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Heading 9\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"lin\":0,\"rin\":0,\"fin\":0,\"ta\":0,\"bs\":2,\"as\":0,\"ls\":1.0791666507720947,\"lst\":0,\"ol\":9,\"lif\":{}},\"cf\":{\"i\":true,\"fsz\":10.5,\"ff\":\"Calibri Light\",\"fc\":\"#333333\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Normal\",\"nx\":\"Normal\"},{\"n\":\"Heading 9 Char\",\"t\":1,\"cf\":{\"i\":true,\"fsz\":10.5,\"ff\":\"Calibri Light\",\"fc\":\"#333333\",\"ffa\":\"Calibri Light\",\"ffnfe\":\"Calibri Light\",\"fffe\":\"Calibri Light\"},\"b\":\"Default Paragraph Font\"},{\"n\":\"Header\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"as\":0,\"ls\":1,\"lst\":0,\"lif\":{}},\"cf\":{},\"b\":\"Normal\",\"nx\":\"Header\"},{\"n\":\"Footer\",\"t\":0,\"pf\":{\"bdrs\":{\"tp\":{},\"lt\":{},\"rg\":{},\"bt\":{},\"h\":{},\"v\":{}},\"as\":0,\"ls\":1,\"lst\":0,\"lif\":{}},\"cf\":{},\"b\":\"Normal\",\"nx\":\"Footer\"}],\"li\":[],\"al\":[],\"cm\":[],\"r\":[],\"cx\":[],\"imgs\":{}}";

            var savedDocumentPath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments), "SFDTDocument.docx");
            var document = WordDocument.Save(sfdtContent, FormatType.Docx);
            using (var fileStream = new FileStream(savedDocumentPath, FileMode.Create, FileAccess.Write))
            {
                document.CopyToAsync(fileStream);
            }
        }




    }
}
